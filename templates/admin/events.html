<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Events - AICC Admin</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="admin-dashboard">
    <nav class="admin-nav">
        <div class="nav-brand">
            <i class="fas fa-shield-alt"></i>
            AICC Admin Panel
        </div>
        <div class="nav-actions">
            <button id="theme-toggle" class="btn-theme">
                <i class="fas fa-sun"></i>
            </button>
            <a href="{{ url_for('admin_dashboard') }}" class="btn-back">
                <i class="fas fa-arrow-left"></i>
                Dashboard
            </a>
            <a href="{{ url_for('admin_logout') }}" class="btn-logout">
                <i class="fas fa-sign-out-alt"></i>
                Logout
            </a>
        </div>
    </nav>
    
    <div class="admin-container">
        <div class="admin-header">
            <div>
                <h1>Manage Events</h1>
                <p>View and manage all club events</p>
            </div>
            <a href="{{ url_for('admin_create_event') }}" class="btn-primary">
                <i class="fas fa-plus"></i>
                Create Event
            </a>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">
                        <i class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-circle' }}"></i>
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <div class="events-grid">
            {% for event in events %}
            <div class="event-card">
                <div class="event-card-image">
                    {% if event.image %}
                    <img src="{{ event.image | cache_bust }}" alt="{{ event.name }}">
                    {% else %}
                    <div class="event-card-image-placeholder">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    {% endif %}
                    <span class="event-badge event-badge-{{ event.status }}">
                        {{ event.status }}
                    </span>
                </div>
                <div class="event-card-content">
                    <h3 class="event-card-title">{{ event.name }}</h3>
                    <div class="event-card-meta">
                        <div class="event-meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>{{ event.date }}</span>
                        </div>
                        <div class="event-meta-item">
                            <i class="fas fa-clock"></i>
                            <span>{{ event.time }}</span>
                        </div>
                        <div class="event-meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ event.location }}</span>
                        </div>
                    </div>
                    <p class="event-card-description">{{ event.description[:120] }}{% if event.description|length > 120 %}...{% endif %}</p>
                </div>
                <div class="event-card-actions">
                    {% if event.registration_type == 'internal' %}
                    <a href="{{ url_for('admin_view_registrations', event_id=event.id) }}" class="btn-action btn-view">
                        <i class="fas fa-users"></i>
                        Registrations
                    </a>
                    {% endif %}
                    <a href="{{ url_for('admin_edit_event', event_id=event.id) }}" class="btn-action btn-edit">
                        <i class="fas fa-edit"></i>
                        Edit
                    </a>
                    <form method="POST" action="{{ url_for('admin_delete_event', event_id=event.id) }}" style="display: inline;">
                        <button type="submit" class="btn-action btn-delete" onclick="event.preventDefault(); showConfirm('Are you sure you want to delete this event?', () => this.form.submit());">
                            <i class="fas fa-trash"></i>
                            Delete
                        </button>
                    </form>
                </div>
            </div>
            {% endfor %}
            
            {% if not events %}
            <div class="empty-state">
                <i class="fas fa-calendar-times"></i>
                <h3>No Events Yet</h3>
                <p>Create your first event to get started</p>
                <a href="{{ url_for('admin_create_event') }}" class="btn-primary">
                    <i class="fas fa-plus"></i>
                    Create Event
                </a>
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmModal" class="custom-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="confirmMessage">Are you sure?</p>
            </div>
            <div class="modal-footer">
                <button class="modal-btn btn-cancel" onclick="closeConfirmModal()">Cancel</button>
                <button class="modal-btn btn-confirm" id="confirmButton">Confirm</button>
            </div>
        </div>
    </div>

    <style>
    .admin-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 2rem;
    }
    
    .events-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: 1.5rem;
        margin-top: 2rem;
    }
    
    .event-card {
        background: var(--card-bg, white);
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border: 1px solid var(--border-color, #e2e8f0);
    }
    
    .event-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    }
    
    .event-card-image {
        position: relative;
        height: 200px;
        overflow: hidden;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .event-card-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    
    .event-card-image-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 4rem;
    }
    
    .event-badge {
        position: absolute;
        top: 12px;
        right: 12px;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .event-badge-upcoming {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
    }
    
    .event-badge-completed {
        background: linear-gradient(135deg, #6b7280, #4b5563);
        color: white;
    }
    
    .event-badge-cancelled {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
    }
    
    .event-card-content {
        padding: 1.25rem;
    }
    
    .event-card-title {
        font-size: 1.25rem;
        font-weight: 700;
        color: var(--text-primary, #0f172a);
        margin: 0 0 1rem 0;
        line-height: 1.3;
    }
    
    .event-card-meta {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        margin-bottom: 1rem;
    }
    
    .event-meta-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary, #64748b);
        font-size: 0.875rem;
    }
    
    .event-meta-item i {
        width: 16px;
        color: var(--admin-primary, #667eea);
    }
    
    .event-card-description {
        color: var(--text-secondary, #64748b);
        font-size: 0.9rem;
        line-height: 1.5;
        margin: 0;
    }
    
    .event-card-actions {
        padding: 1rem 1.25rem;
        background: var(--admin-bg-light, #f8fafc);
        border-top: 1px solid var(--border-color, #e2e8f0);
        display: flex;
        gap: 0.75rem;
    }
    
    .btn-action {
        flex: 1;
        padding: 0.625rem 1rem;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        text-decoration: none;
    }
    
    .btn-edit {
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        color: white;
    }
    
    .btn-edit:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
    }
    
    .btn-delete {
        background: linear-gradient(135deg, #ef4444, #dc2626);
        color: white;
    }
    
    .btn-delete:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }
    
    .empty-state {
        grid-column: 1 / -1;
        text-align: center;
        padding: 4rem 2rem;
        background: var(--card-bg, white);
        border-radius: 16px;
        border: 2px dashed var(--border-color, #e2e8f0);
    }
    
    .empty-state i {
        font-size: 4rem;
        color: var(--text-secondary, #94a3b8);
        margin-bottom: 1rem;
    }
    
    .empty-state h3 {
        font-size: 1.5rem;
        color: var(--text-primary, #0f172a);
        margin: 0 0 0.5rem 0;
    }
    
    .empty-state p {
        color: var(--text-secondary, #64748b);
        margin: 0 0 1.5rem 0;
    }
    
    body[data-theme=dark] .event-card {
        background: #0f172a;
        border-color: #1e293b;
    }
    
    body[data-theme=dark] .event-card-title {
        color: #f1f5f9;
    }
    
    body[data-theme=dark] .event-card-meta,
    body[data-theme=dark] .event-card-description {
        color: #94a3b8;
    }
    
    body[data-theme=dark] .event-card-actions {
        background: #0b1120;
        border-color: #1e293b;
    }
    
    body[data-theme=dark] .empty-state {
        background: #0f172a;
        border-color: #1e293b;
    }
    
    body[data-theme=dark] .empty-state h3 {
        color: #f1f5f9;
    }
    
    .custom-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:10000;animation:fadeIn .2s ease}.custom-modal.show{display:flex;align-items:center;justify-content:center}.modal-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);backdrop-filter:blur(4px)}.modal-content{position:relative;background:var(--card-bg,white);border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.3);max-width:420px;width:90%;animation:slideUp .3s ease;border:1px solid var(--border-color,#e2e8f0)}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{transform:translateY(30px);opacity:0}to{transform:translateY(0);opacity:1}}.modal-header{padding:1.5rem;border-bottom:1px solid var(--border-color,#e2e8f0);display:flex;align-items:center;gap:.75rem}.modal-header i{color:#f59e0b;font-size:1.5rem}.modal-header h3{margin:0;font-size:1.25rem;font-weight:700;color:var(--text-primary,#0f172a)}.modal-body{padding:1.5rem}.modal-body p{margin:0;color:var(--text-secondary,#64748b);font-size:1rem;line-height:1.6}.modal-footer{padding:1.5rem;border-top:1px solid var(--border-color,#e2e8f0);display:flex;gap:.75rem;justify-content:flex-end}.modal-btn{padding:.75rem 1.5rem;border-radius:10px;font-weight:600;border:none;cursor:pointer;transition:all .2s ease;font-size:.95rem}.btn-cancel{background:var(--card-bg,white);color:var(--text-primary,#0f172a);border:1px solid var(--border-color,#e2e8f0)}.btn-cancel:hover{background:#f8fafc}.btn-confirm{background:linear-gradient(135deg,#ef4444,#dc2626);color:white;box-shadow:0 4px 12px rgba(239,68,68,.3)}.btn-confirm:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgba(239,68,68,.4)}body[data-theme=dark] .modal-content{background:#0f172a}body[data-theme=dark] .modal-header h3{color:#f1f5f9}body[data-theme=dark] .modal-body p{color:#94a3b8}body[data-theme=dark] .btn-cancel{background:#0b1120;color:#f1f5f9;border-color:#1e293b}
    </style>

    <script>
    let confirmCallback=null;function showConfirm(message,onConfirm){document.getElementById('confirmMessage').textContent=message;document.getElementById('confirmModal').classList.add('show');confirmCallback=onConfirm}function closeConfirmModal(){document.getElementById('confirmModal').classList.remove('show');confirmCallback=null}document.getElementById('confirmButton').addEventListener('click',()=>{if(confirmCallback){confirmCallback()}closeConfirmModal()});document.querySelector('.modal-overlay').addEventListener('click',closeConfirmModal);
    </script>
    
    <script src="{{ url_for('static', filename='js/admin-theme.js') }}"></script>
</body>
</html>
